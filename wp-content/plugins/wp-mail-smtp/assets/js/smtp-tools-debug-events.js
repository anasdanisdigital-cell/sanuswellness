'use strict';var WPMailSmtpDebugEvents=window.WPMailSmtpDebugEvents||(function(document,window,$){var el={$debugEventsPage:$('.wp-mail-smtp-tab-tools-debug-events'),$dateFlatpickr:$('.wp-mail-smtp-filter-date-selector'),};var app={init:function(){$(app.ready);},ready:function(){app.initDateRange();app.events();var searchParams=new URLSearchParams(location.search);if(searchParams.has('debug_event_id')){app.openDebugEventPopup(searchParams.get('debug_event_id'));}},events:function(){el.$debugEventsPage.on('click','#wp-mail-smtp-reset-filter .reset',app.resetFilter);el.$debugEventsPage.on('click','#wp-mail-smtp-delete-all-debug-events-button',app.deleteAllDebugEvents);el.$debugEventsPage.on('click','.js-wp-mail-smtp-debug-event-preview',app.eventClicked);},initDateRange:function(){var langCode=wp_mail_smtp_tools_debug_events.lang_code,flatpickrLocale={rangeSeparator:' - ',};if(flatpickr!=='undefined'&&Object.prototype.hasOwnProperty.call(flatpickr,'l10ns')&&Object.prototype.hasOwnProperty.call(flatpickr.l10ns,langCode)){flatpickrLocale=flatpickr.l10ns[langCode];flatpickrLocale.rangeSeparator=' - ';}
el.$dateFlatpickr.flatpickr({altInput:true,altFormat:'M j, Y',dateFormat:'Y-m-d',locale:flatpickrLocale,mode:'range'});},resetFilter:function(){var $form=$(this).parents('form');$form.find($(this).data('scope')).find('input,select').each(function(){var $this=$(this);if(app.isIgnoredForResetInput($this)){return;}
app.resetInput($this);});$form.submit();},resetInput:function($input){switch($input.prop('tagName').toLowerCase()){case'input':$input.val('');break;case'select':$input.val($input.find('option').first().val());break;}},isIgnoredForResetInput:function($input){return['submit','hidden'].indexOf(($input.attr('type')||'').toLowerCase())!==-1&&!$input.hasClass('flatpickr-input');},deleteAllDebugEvents:function(event){event.preventDefault();var $btn=$(event.target);$.confirm({backgroundDismiss:false,escapeKey:true,animationBounce:1,closeIcon:true,type:'orange',icon:app.getModalIcon('exclamation-circle-solid-orange'),title:wp_mail_smtp_tools_debug_events.texts.notice_title,content:wp_mail_smtp_tools_debug_events.texts.delete_all_notice,buttons:{confirm:{text:wp_mail_smtp_tools_debug_events.texts.yes,btnClass:'btn-confirm',keys:['enter'],action:function(){app.executeAllDebugEventsDeletion($btn);}},cancel:{text:wp_mail_smtp_tools_debug_events.texts.cancel,btnClass:'btn-cancel',}}});},eventClicked:function(event){event.preventDefault();app.openDebugEventPopup($(this).data('event-id'));},openDebugEventPopup:function(eventId){var data={action:'wp_mail_smtp_debug_event_preview',id:eventId,nonce:$('#wp-mail-smtp-debug-events-nonce',el.$debugEventsPage).val()};var popup=$.alert({backgroundDismiss:true,escapeKey:true,animationBounce:1,type:'blue',icon:app.getModalIcon('info-circle-blue'),title:false,content:wp_mail_smtp_tools_debug_events.loader,boxWidth:'550px',buttons:{confirm:{text:wp_mail_smtp_tools_debug_events.texts.close,btnClass:'btn-confirm',keys:['enter']}},onOpenBefore:function(){this.$contentPane.addClass('no-scroll');}});$.post(ajaxurl,data,function(response){if(response.success){popup.setTitle(response.data.title);popup.setContent(response.data.content);}else{popup.setIcon(app.getModalIcon('exclamation-circle-regular-red'));popup.setType('red');popup.setContent(response.data);}}).fail(function(){popup.setContent(wp_mail_smtp_tools_debug_events.texts.error_occurred);});},executeAllDebugEventsDeletion:function($btn){$btn.prop('disabled',true);var data={action:'wp_mail_smtp_delete_all_debug_events',nonce:$('#wp-mail-smtp-debug-events-nonce',el.$debugEventsPage).val()};$.post(ajaxurl,data,function(response){var message=response.data,icon,type,callback;if(response.success){icon='check-circle-solid-green';type='green';callback=function(){location.reload();return false;};}else{icon='exclamation-circle-regular-red';type='red';}
app.displayModal(message,icon,type,callback);$btn.prop('disabled',false);}).fail(function(){app.displayModal(wp_mail_smtp_tools_debug_events.texts.error_occurred,'exclamation-circle-regular-red','red');$btn.prop('disabled',false);});},displayModal:function(message,icon,type,actionCallback){type=type||'default';actionCallback=actionCallback||function(){};$.alert({backgroundDismiss:true,escapeKey:true,animationBounce:1,type:type,closeIcon:true,title:false,icon:icon?app.getModalIcon(icon):'',content:message,buttons:{confirm:{text:wp_mail_smtp_tools_debug_events.texts.ok,btnClass:'wp-mail-smtp-btn wp-mail-smtp-btn-md',keys:['enter'],action:actionCallback}}});},getModalIcon:function(icon){return'"></i><img src="'+wp_mail_smtp_tools_debug_events.plugin_url+'/assets/images/font-awesome/'+icon+'.svg" style="width: 40px; height: 40px;" alt=""><i class="';},};return app;}(document,window,jQuery));WPMailSmtpDebugEvents.init();