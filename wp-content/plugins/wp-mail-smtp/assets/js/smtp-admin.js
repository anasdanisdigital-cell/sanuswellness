'use strict';var WPMailSMTP=window.WPMailSMTP||{};WPMailSMTP.Admin=WPMailSMTP.Admin||{};WPMailSMTP.Admin.Settings=WPMailSMTP.Admin.Settings||(function(document,window,$){var app={pluginSettingsChanged:false,init:function(){$(app.ready);},ready:function(){app.pageHolder=$('.wp-mail-smtp-tab-settings');app.settingsForm=$('.wp-mail-smtp-connection-settings-form');$('#screen-meta-links, #screen-meta').prependTo('#wp-mail-smtp-header-temp').show();app.bindActions();app.setJQueryConfirmDefaults();app.initFlyoutMenu();},bindActions:function(){$('.wp-mail-smtp-mailer-image',app.settingsForm).on('click',function(){$(this).parents('.wp-mail-smtp-mailer').find('input').trigger('click');});$('.wp-mail-smtp-mailer input',app.settingsForm).on('click',function(){var $input=$(this);if($input.prop('disabled')){if($input.hasClass('educate')){app.education.upgradeMailer($input);}
return false;}
$('.wp-mail-smtp-mailer',app.settingsForm).removeClass('active');$(this).parents('.wp-mail-smtp-mailer').addClass('active');$('.wp-mail-smtp-mailer-option',app.settingsForm).addClass('hidden').removeClass('active');$('.wp-mail-smtp-mailer-option-'+$(this).val(),app.settingsForm).addClass('active').removeClass('hidden');});app.mailers.smtp.bindActions();$('#wp-mail-smtp-pro-banner-dismiss',app.pageHolder).on('click',function(){$.ajax({url:ajaxurl,dataType:'json',type:'POST',data:{action:'wp_mail_smtp_ajax',task:'pro_banner_dismiss',nonce:wp_mail_smtp.nonce}}).always(function(){$('#wp-mail-smtp-pro-banner',app.pageHolder).fadeOut('fast');});});$('.js-wp-mail-smtp-mailer-notice-dismiss',app.settingsForm).on('click',function(e){e.preventDefault();var $btn=$(this),$notice=$btn.parents('.inline-notice');if($btn.hasClass('disabled')){return false;}
$.ajax({url:ajaxurl,dataType:'json',type:'POST',data:{action:'wp_mail_smtp_ajax',nonce:wp_mail_smtp.nonce,task:'notice_dismiss',notice:$notice.data('notice'),mailer:$notice.data('mailer')},beforeSend:function(){$btn.addClass('disabled');}}).always(function(){$notice.fadeOut('fast',function(){$btn.removeClass('disabled');});});});$('#wp-mail-smtp-debug .error-log-toggle').on('click',function(e){e.preventDefault();$('#wp-mail-smtp-debug .error-log').slideToggle();});$('#wp-mail-smtp-debug .error-log-copy').on('click',function(e){e.preventDefault();var $self=$(this);var $content=$('#wp-mail-smtp-debug .error-log');if(!$content.is(':visible')){$content.addClass('error-log-selection');}
var range=document.createRange();range.selectNode($content[0]);window.getSelection().removeAllRanges();window.getSelection().addRange(range);document.execCommand('Copy');window.getSelection().removeAllRanges();$content.removeClass('error-log-selection');$self.addClass('error-log-copy-copied');setTimeout(function(){$self.removeClass('error-log-copy-copied');},1500);});$('.js-wp-mail-smtp-provider-remove',app.settingsForm).on('click',function(){return confirm(wp_mail_smtp.text_provider_remove);});$('.wp-mail-smtp-setting-copy',app.settingsForm).on('click',function(e){e.preventDefault();var target=$('#'+$(this).data('source_id')).get(0);target.select();document.execCommand('Copy');var $buttonIcon=$(this).find('.dashicons');$buttonIcon.removeClass('dashicons-admin-page').addClass('wp-mail-smtp-dashicons-yes-alt-green wp-mail-smtp-success wp-mail-smtp-animate');setTimeout(function(){$buttonIcon.removeClass('wp-mail-smtp-dashicons-yes-alt-green wp-mail-smtp-success wp-mail-smtp-animate').addClass('dashicons-admin-page');},1000);});$('#wp-mail-smtp-notice-bar').on('click','.dismiss',function(){var $notice=$(this).closest('#wp-mail-smtp-notice-bar');$notice.addClass('out');setTimeout(function(){$notice.remove();},300);$.post(ajaxurl,{action:'wp_mail_smtp_notice_bar_dismiss',nonce:wp_mail_smtp.nonce,});});app.triggerExitNotice();app.beforeSaveChecks();$('.js-wp-mail-smtp-setting-mailer-radio-input',app.settingsForm).on('change',this.processMailerSettingsOnChange);$('.wp-mail-smtp-tab-tools-test #email-test-form').on('submit',function(){var $button=$(this).find('.wp-mail-smtp-btn');$button.attr('disabled',true);$button.find('span').hide();$button.find('.wp-mail-smtp-loading').show();});$('#wp-mail-smtp-setting-gmail-one_click_setup_enabled-lite').on('click',function(e){e.preventDefault();app.education.gmailOneClickSetupUpgrade();});$('#wp-mail-smtp-setting-misc-rate_limit-lite').on('click',function(e){e.preventDefault();app.education.rateLimitUpgrade();});$('.wp-mail-smtp-btn[data-clear-field]').on('click',function(e){var $button=$(this);var fieldId=$button.attr('data-clear-field');var $field=$(`#${fieldId}`);$field.prop('disabled',false);$field.attr('name',$field.attr('data-name'));$field.removeAttr('value');$field.focus();$button.remove();});$('.email_test_tab_removal_notice').on('click','.notice-dismiss',function(){var $button=$(this);$.ajax({url:ajaxurl,dataType:'json',type:'POST',data:{action:'wp_mail_smtp_ajax',nonce:wp_mail_smtp.nonce,task:'email_test_tab_removal_notice_dismiss',},beforeSend:function(){$button.prop('disabled',true);},});});},education:{upgradeMailer:function($input){var mailerName=$input.data('title').trim();app.education.upgradeModal(wp_mail_smtp.education.upgrade_title.replace(/%name%/g,mailerName),wp_mail_smtp.education.upgrade_content.replace(/%name%/g,mailerName),$input.val());},gmailOneClickSetupUpgrade:function(){app.education.upgradeModal(wp_mail_smtp.education.gmail.one_click_setup_upgrade_title,wp_mail_smtp.education.gmail.one_click_setup_upgrade_content,'gmail-one-click-setup');},rateLimitUpgrade:function(){app.education.upgradeModal(wp_mail_smtp.education.rate_limit.upgrade_title,wp_mail_smtp.education.rate_limit.upgrade_content,'rate-limit-setting');},upgradeModal:function(title,content,upgradeUrlUtmContent){$.alert({backgroundDismiss:true,escapeKey:true,animationBounce:1,type:'blue',closeIcon:true,title:title,icon:'"></i>'+wp_mail_smtp.education.upgrade_icon_lock+'<i class="',content:content,boxWidth:'550px',onOpenBefore:function(){this.$btnc.after('<div class="discount-note">'+wp_mail_smtp.education.upgrade_bonus+wp_mail_smtp.education.upgrade_doc+'</div>');this.$body.addClass('wp-mail-smtp-upgrade-mailer-education-modal');},buttons:{confirm:{text:wp_mail_smtp.education.upgrade_button,btnClass:'btn-confirm',keys:['enter'],action:function(){var appendChar=/(\?)/.test(wp_mail_smtp.education.upgrade_url)?'&':'?',upgradeURL=wp_mail_smtp.education.upgrade_url+appendChar+'utm_content='+encodeURIComponent(upgradeUrlUtmContent);window.open(upgradeURL,'_blank');}}}});}},mailers:{smtp:{bindActions:function(){$('#wp-mail-smtp-setting-smtp-auth').on('change',function(){$('#wp-mail-smtp-setting-row-smtp-user, #wp-mail-smtp-setting-row-smtp-pass').toggleClass('inactive');});$('#wp-mail-smtp-setting-row-smtp-encryption input').on('change',function(){var $input=$(this),$smtpPort=$('#wp-mail-smtp-setting-smtp-port',app.settingsForm);if('tls'===$input.val()){$smtpPort.val('587');$('#wp-mail-smtp-setting-row-smtp-autotls').addClass('inactive');}else if('ssl'===$input.val()){$smtpPort.val('465');$('#wp-mail-smtp-setting-row-smtp-autotls').removeClass('inactive');}else{$smtpPort.val('25');$('#wp-mail-smtp-setting-row-smtp-autotls').removeClass('inactive');}});}}},triggerExitNotice:function(){var $settingPages=$('.wp-mail-smtp-page-general');$(window).on('beforeunload',function(){if(app.pluginSettingsChanged){return wp_mail_smtp.text_settings_not_saved;}});$(':input:not( #wp-mail-smtp-setting-license-key, .wp-mail-smtp-not-form-input, #wp-mail-smtp-setting-gmail-one_click_setup_enabled, #wp-mail-smtp-setting-outlook-one_click_setup_enabled )',$settingPages).on('change',function(){app.pluginSettingsChanged=true;});$('form',$settingPages).on('submit',function(){app.pluginSettingsChanged=false;});},beforeSaveChecks:function(){app.settingsForm.on('submit',function(){if($('.wp-mail-smtp-mailer input:checked',app.settingsForm).val()==='mail'){var $thisForm=$(this);$.alert({backgroundDismiss:false,escapeKey:false,animationBounce:1,type:'orange',icon:'"></i><img src="'+wp_mail_smtp.plugin_url+'/assets/images/font-awesome/exclamation-circle-solid-orange.svg" style="width: 40px; height: 40px;" alt="'+wp_mail_smtp.default_mailer_notice.icon_alt+'"><i class="',title:wp_mail_smtp.default_mailer_notice.title,content:wp_mail_smtp.default_mailer_notice.content,boxWidth:'550px',buttons:{confirm:{text:wp_mail_smtp.default_mailer_notice.save_button,btnClass:'btn-confirm',keys:['enter'],action:function(){$thisForm.off('submit').trigger('submit');}},cancel:{text:wp_mail_smtp.default_mailer_notice.cancel_button,btnClass:'btn-cancel',},}});return false;}});},processMailerSettingsOnChange:function(){var mailerSupportedSettings=wp_mail_smtp.all_mailers_supports[$(this).val()];for(var setting in mailerSupportedSettings){if(mailerSupportedSettings.hasOwnProperty(setting)){$('.js-wp-mail-smtp-setting-'+setting,app.settingsForm).toggle(mailerSupportedSettings[setting]);}}
var $mainSettingInGroup=$('.js-wp-mail-smtp-setting-from_email');$mainSettingInGroup.toggle(mailerSupportedSettings['from_email']||mailerSupportedSettings['from_email_force']);$mainSettingInGroup=$('.js-wp-mail-smtp-setting-from_name');$mainSettingInGroup.toggle(mailerSupportedSettings['from_name']||mailerSupportedSettings['from_name_force']);},setJQueryConfirmDefaults:function(){jconfirm.defaults={typeAnimated:false,draggable:false,animateFromElement:false,theme:'modern',boxWidth:'400px',useBootstrap:false};},initFlyoutMenu:function(){var $flyoutMenu=$('#wp-mail-smtp-flyout');if($flyoutMenu.length===0){return;}
var $head=$flyoutMenu.find('.wp-mail-smtp-flyout-head');$head.on('click',function(e){e.preventDefault();$flyoutMenu.toggleClass('opened');});var $wpfooter=$('#wpfooter');if($wpfooter.length===0){return;}
var $overlap=$('.wp-mail-smtp-page-logs-archive, '+'.wp-mail-smtp-tab-tools-action-scheduler, '+'.wp-mail-smtp-page-reports, '+'.wp-mail-smtp-tab-tools-debug-events, '+'.wp-mail-smtp-tab-connections');$(window).on('resize scroll',_.debounce(function(){var wpfooterTop=$wpfooter.offset().top,wpfooterBottom=wpfooterTop+$wpfooter.height(),overlapBottom=$overlap.length>0?$overlap.offset().top+$overlap.height()+85:0,viewTop=$(window).scrollTop(),viewBottom=viewTop+$(window).height();if(wpfooterBottom<=viewBottom&&wpfooterTop>=viewTop&&overlapBottom>viewBottom){$flyoutMenu.addClass('out');}else{$flyoutMenu.removeClass('out');}},50));$(window).trigger('scroll');}};return app;}(document,window,jQuery));WPMailSMTP.Admin.Settings.init();